

<!DOCTYPE html>
<html>
	<link href ="/css/play.css" rel ="stylesheet">
	<script defer src = "/js/fontawesome-all.js"></script>
	<div class ="container">
	<head>
		<a href ="/"><i class ="fa fa-home fa-2x"></i></a>
		<title>FocusFriend</title>
		<center>
			<h1>Focus Together!</h1>
			<script src="http://code.jquery.com/jquery-latest.min.js" type="text/javascript"></script>
			<!-- we should put their chosen animal var here later -->
			<img id="image" src="./images/happy1.png" alt="MISSING CHARACTER PNG" > <br> 
	</head>
	<body>

				<p id="demo"></p>

			<button onclick ="completeTask()">Click When Time's Up to Finish!</button>

			<!-- timer implemented below -->
			<script>
				function completeTask (){
				setTimeout(function(){ alert("Good job! Go Home and rest"); }, 3000);
				}
 				//setTimeout(function(){ alert("Good job!"); }, 3000);
			//	}
			</script>
			<!-- timer implemented below -->
			<script>

				var image=document.getElementById("image");
			    var currentPos = 0;
			    //add ,"" to cycle through all images
			    var images = ["./images/happy2.png"]

			    function fotoGood() {
			        if (++currentPos >= images.length) currentPos = 0;
			        image.src = images[currentPos];
			    }

			    function fotoSad() {
			        image.src = "./images/Sad.png";
			        hasBeenSad = true;
			    }
			    //about 5 second. will change to half hour after test
			    setInterval(fotoGood, 5000);


var lastClick = 0;
var timeSince = 0;
var isActive;

//for all events
//$('*').on('blur change click dblclick error focus focusin focusout hover keydown keypress keyup load mousedown mouseenter mouseleave mousemove mouseout mouseover mouseup resize scroll select submit', function() {

function howlong() {
    timeSince = ((new Date()).getTime() - lastClick);
}


// tests if it has been 15 seconds since the user has been on their phone, and the reason for not in focus is lock screen (40 sec for me)
function userActive(x)	{
	//if not in focus, but theyr active, its their fault
    if (x < 5000) {
  		isActive = true;
  	}
  	//lock screen activates
  	else if (x > 5000) {
  		isActive = false;
  	}
}
setInterval("howlong()", 10);
setInterval("userActive(timeSince)", 10);



//LINK TO 'GO' BUTTON AFTER TIME IS INPUT. DISABLE ON RETURN TO HOME BUTTON IF FAILED OR TIME UP
//seems to interfere with the else in hasfocus
/*var noSleep = new NoSleep();

function enableNoSleep() {
  noSleep.enable();
  document.removeEventListener('touchstart', enableNoSleep, false);
}

// Enable wake lock.
// (must be wrapped in a user input event handler e.g. a mouse or touch handler)
document.addEventListener('touchstart', enableNoSleep, false);
//Once you want to cede control of sleep, simply call the disable method:

// Disable wake lock at some point in the future.
// (does not need to be wrapped in any user input event handler)
noSleep.disable();
*/


setInterval("myFunction()", 10);

function myFunction() {

//whenever you click reset lastclick and user
$("body").click(function () {
    lastClick = (new Date()).getTime();
    isActive = true;
    timeSince = 0;
});
	
    var x = document.getElementById("demo");
    //shouln't affect timeout
    if (document.hasFocus()) {
    	if (hasBeenSad == true) {

    		//find a way to start cycle over.
    		//also if you add another happy pic you can see that it cycles continueously. must fix
    	}
    	//setTimeout({image.src = "./images/happy1.png";}
//setInterval("howlong()", 10);
//setInterval("userActive(timeSince)", 10);
  //      x.innerHTML = isActive + "because time since is last click is: " + timeSince;
    }
    // doc is not in focus and has been touching 
    else {
 
   // 	howlong();
    	//if docs not in focus and theyre active its not timeout, its them
    	//if (isActive == true) {
	  	//document.write("timeSince: " + timeSince);
	  		//document.write("fail");
	  		fotoSad();

  		//}
    }
}
			</script>
		</center>
	</body>
	</div>
</html>
